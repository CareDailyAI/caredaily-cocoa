//
//  PPAppResources.m
//  Peoplepower
//
//  Created by Destry Teeter on 3/15/18.
//  Copyright Â© 2020 People Power Company. All rights reserved.
//

#import "PPAppResources.h"

#pragma mark - Files

NSString *PLIST_FILE_UNIT_TESTS = @"UnitTests";
NSString *PLIST_FILE_CONFIG = @"Peoplepower-Config";
NSString *PLIST_FILE_ATTRIBUTIONS = @"Peoplepower-Attributions";

#pragma mark - Config

NSString *PLIST_KEY_CONFIG_APP_NAME = @"PPAppName";
NSString *PLIST_KEY_CONFIG_COMPANY_NAME = @"PPCompanyName";
NSString *PLIST_KEY_CONFIG_BRAND = @"PPBrand";
NSString *PLIST_KEY_CONFIG_CLOUD = @"PPCloudConnectivityCloud";
NSString *PLIST_KEY_CONFIG_COLORS = @"PPColors";

#pragma mark - Attributions

NSString *PLIST_KEY_ATTRIBUTIONS_ATTRIBUTIONS = @"PPAttributions";

#pragma mark - Versioning

NSString *PLIST_KEY_CONFIG_IOT_ICONS_VERSION = @"PPIOTIconsVersion";

#pragma mark - Unit Testing

#pragma mark - Server Settings

NSString *PLIST_KEY_TEST_APP_NAME = @"PPTCAppName";
NSString *PLIST_KEY_TEST_BRAND = @"PPTCBrand";
NSString *PLIST_KEY_TEST_CLOUD = @"PPTCCloudConnectivityCloud";
NSString *PLIST_KEY_TEST_SERVER_URL = @"https://sbox.presencepro.com";

#pragma mark - User Accounts

NSString *PLIST_KEY_TEST_USER_ACCOUNTS_PASSWORD = @"PPTCUserAccountsPassword";
NSString *PLIST_KEY_TEST_USER_ACCOUNTS_USERNAME = @"PPTCUserAccountsUsername";

NSString *PLIST_KEY_TEST_USER_ACCOUNTS_TEST_USER = @"PPTCUserAccountsTestUser";
NSString *PLIST_KEY_TEST_USER_ACCOUNTS_TEST_USER_2 = @"PPTCUserAccountsTestUser2";
NSString *PLIST_KEY_TEST_USER_ACCOUNTS_TEST_USER_3 = @"PPTCUserAccountsTestUser3";

NSString *PLIST_KEY_TEST_USER_ACCOUNTS_TEST_LOCATION = @"PPTCUserAccountsTestLocation";
NSString *PLIST_KEY_TEST_USER_ACCOUNTS_TEST_LOCATION_2 = @"PPTCUserAccountsTestLocation2";
NSString *PLIST_KEY_TEST_USER_ACCOUNTS_TEST_LOCATION_3 = @"PPTCUserAccountsTestLocation3";

NSString *PLIST_KEY_TEST_USER_ACCOUNTS_LOCATION_SPACE = @"PPTCUserAccountsLocationSpace";

NSString *PLIST_KEY_TEST_USER_ACCOUNTS_NARRATIVE = @"PPTCUserAccountsNarrative";

#pragma mark - Devices

NSString *PLIST_KEY_TEST_DEVICES_LOCAL_DEVICE = @"PPTCDevicesLocalDevice";
NSString *PLIST_KEY_TEST_DEVICES_PROPERTIES = @"PPTCDevicesProperties";
NSString *PLIST_KEY_TEST_DEVICES_VIDEO_TOKENS = @"PPTCDevicesVideoTokens";

#pragma mark - Device Measurements

NSString *PLIST_KEY_TEST_DEVICE_MEASUREMENTS_PARAMETERS = @"PPTCDeviceMeasurementsParameters";

#pragma mark - Communications

#pragma mark Notifications

NSString *PLIST_KEY_TEST_NOTIFICATION_TOKEN = @"PPTCNotificationToken";
NSString *PLIST_KEY_TEST_NOTIFICATION_PUSH_MESSAGE = @"PPTCNotificationPushMessage";
NSString *PLIST_KEY_TEST_NOTIFICATION_EMAIL_MESSAGE = @"PPTCNotificationEmailMessage";
NSString *PLIST_KEY_TEST_NOTIFICATION_SMS_MESSAGE = @"PPTCNotificationSMSMessage";

#pragma mark Crowd Feedback

NSString *PLIST_KEY_TEST_CROWD_FEEDBACK_FEEDBACK = @"PPTCCrowdFeedbacksFeedback";
NSString *PLIST_KEY_TEST_CROWD_FEEDBACK_FEEDBACK_SUPPORT = @"PPTCCrowdFeedbacksFeedbackSupport";

#pragma mark In-App Messaging

NSString *PLIST_KEY_TEST_IN_APP_MESSAGING_MESSAGE = @"PPTCInApMessagingMessage";

#pragma mark Questions

NSString *PLIST_KEY_TEST_QUESTIONS = @"PPTCQuestions";

#pragma mark SMS Group Texting

NSString *PLIST_KEY_TEST_SMS_GROUP_TEXTING_SUBSCRIBER = @"PPTCSMSGroupTextingSubscriber";

#pragma mark - User and System Properties

NSString *PLIST_KEY_TEST_SYSTEM_AND_USER_PROPERTIES = @"PPTCSystemAndUserProperties";

#pragma mark - File Management

NSString *PLIST_KEY_TEST_FILE_MANAGEMENT_IMAGE = @"PPTCFileManagementImage";
NSString *PLIST_KEY_TEST_FILE_MANAGEMENT_VIDEO = @"PPTCFileManagementVideo";
NSString *PLIST_KEY_TEST_FILE_MANAGEMENT_AUDIO = @"PPTCFileManagementAudio";

#pragma mark - Rules

NSString *PLIST_KEY_TEST_RULES_RULE = @"PPTCRulesRule";
NSString *PLIST_KEY_TEST_RULES_GOAL = @"PPTCRulesGoal";

#pragma mark - Professional Monitoring

NSString *PLIST_KEY_TEST_PROFESSIONAL_MONITORING_CALL_CENTER = @"PPTCProfessionalMonitoringCallCenter";

#pragma mark - Energy Management

NSString *PLIST_KEY_TEST_ENERGY_MANAGEMENT_UTILITY_BILL = @"PPTCEnergyManagementUtilityBill";
NSString *PLIST_KEY_TEST_ENERGY_MANAGEMENT_BILLING_INFO = @"PPTCEnergyManagementBillingInfo";

#pragma mark - Products

NSString *PLIST_KEY_TEST_PRODUCTS_DEVICE_TYPE = @"PPTCProductsDeviceType";
NSString *PLIST_KEY_TEST_PRODUCTS_PARAMETER = @"PPTCProductsParameter";
NSString *PLIST_KEY_TEST_PRODUCTS_RULE_PHRASE = @"PPTCProductsRulePhrase";
NSString *PLIST_KEY_TEST_PRODUCTS_MEDIA = @"PPTCProductsMedia";
NSString *PLIST_KEY_TEST_PRODUCTS_MODEL = @"PPTCProductsModel";
NSString *PLIST_KEY_TEST_PRODUCTS_CATEGORY = @"PPTCProductsCategory";
NSString *PLIST_KEY_TEST_PRODUCTS_STORY = @"PPTCProductsStory";

#pragma mark - OAuth

NSString *PLIST_KEY_TEST_OAUTH_CLIENT_APPLICATION_ID = @"PPTCOAuthClientApplicationId";
NSString *PLIST_KEY_TEST_OAUTH_HOST_CLIENT_ID = @"PPTCOAuthHostClientId";

#pragma mark - Friends

NSString *PLIST_KEY_TEST_FRIENDS_FRIEND = @"PPTCFriendsFriend";

#pragma mark - Circles

NSString *PLIST_KEY_TEST_CIRCLES_CIRCLE = @"PPTCCirclesCircle";
NSString *PLIST_KEY_TEST_CIRCLES_MEMBER = @"PPTCCirclesMember";
NSString *PLIST_KEY_TEST_CIRCLES_POST = @"PPTCCirclesPost";

#pragma mark - Community

NSString *PLIST_KEY_TEST_COMMUNITY_POST = @"PPTCCommunityPost";
NSString *PLIST_KEY_TEST_COMMUNITY_COMMENT = @"PPTCCommunityComment";
NSString *PLIST_KEY_TEST_COMMUNITY_FILE_VIDEO = @"PPTCCommunityFileVideo";
NSString *PLIST_KEY_TEST_COMMUNITY_FILE_IMAGE = @"PPTCCommunityFileImage";
NSString *PLIST_KEY_TEST_COMMUNITY_FILE_AUDIO = @"PPTCCommunityFileAudio";

@implementation PPAppResources

+ (NSObject *)getPlistEntry:(NSString *)key filename:(NSString *)filename {
    NSBundle *bundle = [NSBundle bundleForClass:[self class]];
    NSDictionary *plist = [NSDictionary dictionaryWithContentsOfFile:[bundle pathForResource:filename ofType:@"plist"]];
    
    // Retreive overrides
    NSDictionary *plistOverride = [NSDictionary dictionaryWithContentsOfFile:[bundle pathForResource:[NSString stringWithFormat:@"%@-Override", filename] ofType:@"plist"]];
    NSObject *value;
    if(plistOverride != nil) {
        value = [PPAppResources plistEntryForKey:key inPlist:plistOverride];
    }
    
    // Fallback to original settings
    if (value == nil) {
        value = [PPAppResources plistEntryForKey:key inPlist:plist];
    }
    return value;
}

+ (NSObject *)plistEntryForKey:(NSString *)key inPlist:(NSDictionary *)plist {
    NSString *value;
    for(NSString *plistKey in [plist allKeys]) {
        if([plistKey isEqualToString:key]) {
            value = [plist objectForKey:key];
            break;
        }
        else {
            NSObject *o = [plist objectForKey:plistKey];
            if([o isKindOfClass:[NSDictionary class]]) {
                for(NSString *plistKeyB in [[plist objectForKey:plistKey] allKeys]) {
                    if([plistKeyB isEqualToString:key]) {
                        value = [[plist objectForKey:plistKey] objectForKey:key];
                        break;
                    }
                }
                if(value) {
                    break;
                }
            }
        }
    }
    return value;
}

@end
